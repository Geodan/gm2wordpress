{"version":3,"file":"gdmap-auth.js","sources":["NamespaceAuth.js","AuthUser.js","AuthManager.js","gdmap-auth.js"],"names":["define","G","auth","version","AuthUser","core","Class","extend","_id","_displayName","_organisationName","_organisationCode","_json","initialize","jsonObject","this","id","displayName","groups","length","name","value","Object","defineProperty","get","AuthManager","statics","DEFAULT_WHOAMI_SERVICE","DEFAULT_LOGOUT_SERVICE","DEFAULT_FORWARD_URL","_currentUser","whoAmIServiceUrl","logoutServiceUrl","autoRefresh","_whoAmIUrl","ClassName","_logoutUrl","_autoRefresh","undefined","identifyUser","options","requestManager","RequestManager","request","self","then","data","textStatus","jqXHR","getResponseHeader","indexOf","window","location","reload","errorThrown","logout","forwardUrl","url","open"],"mappings":"AAAA,AAAAA,OAAA,iBACA,cAEA,SACAC,GAGA,YAYA,OAPAA,GAAAC,QAKAD,EAAAC,KAAAC,QAAA,iBAEAF,IAEAD,OAAA,YCpBA,iBAEA,SACAC,GAGA,YAEAA,GAAAC,KAAAE,SAAAH,EAAAI,KAAAC,MAAAC,QACAC,IAAA,KACAC,aAAA,KACAC,kBAAA,KACAC,kBAAA,KACAC,MAAA,KAEAC,WAAA,SAAAC,GAEAC,KAAAH,MAAAE,EACA,OAAAA,IAEAC,KAAAP,IAAAM,EAAAE,IAAA,KACAD,KAAAN,aAAAK,EAAAG,aAAA,GACAH,EAAAI,OAAAC,OAAA,GAEAJ,KAAAL,kBAAAI,EAAAI,OAAA,GAAAE,KACAL,KAAAJ,kBAAAG,EAAAI,OAAA,GAAAG,QAIAN,KAAAL,kBAAA,GACAK,KAAAJ,kBAAA,KAIAW,OAAAC,eAAAR,KAAA,MACAS,IAAA,WACA,MAAAT,MAAAP,OAIAc,OAAAC,eAAAR,KAAA,eACAS,IAAA,WACA,MAAAT,MAAAN,gBAIAa,OAAAC,eAAAR,KAAA,oBACAS,IAAA,WACA,MAAAT,MAAAL,qBAIAY,OAAAC,eAAAR,KAAA,oBACAS,IAAA,WACA,MAAAT,MAAAJ,qBAIAW,OAAAC,eAAAR,KAAA,QACAS,IAAA,WACA,MAAAT,MAAAH,cAMAZ,OAAA,eClEA,gBACA,YAEA,SAAAC,GACA,YAEAA,GAAAC,KAAAuB,YAAAxB,EAAAI,KAAAC,MAAAC,QACAmB,SACAC,uBAAA,8CACAC,uBAAA,wCACAC,oBAAA,wBAGAC,aAAA,KAEAjB,WAAA,SAAAkB,EAAAC,EAAAC,GACAlB,KAAAe,aAAA,KACAf,KAAAmB,WAAAH,EAAAA,EAAAI,EAAAR,uBACAZ,KAAAqB,WAAAJ,EAAAA,EAAAG,EAAAP,uBACAb,KAAAsB,aAAAC,SAAAL,GAAA,OAAAA,GAAA,EAAAA,EAEAX,OAAAC,eAAAR,KAAA,eACAS,IAAA,WACA,MAAAT,MAAAe,iBAKAS,aAAA,SAAAC,GACAzB,KAAAe,aAAA,IACA,IAAAW,GAAA,GAAAxC,GAAAI,KAAAqC,eACAC,EAAAF,EAAAjB,IAAAT,KAAAmB,WAAAM,GACAI,EAAA7B,IAiBA,OAhBA4B,GAAAE,KACA,SAAAC,EAAAC,EAAAC,GACA,KAAAA,EAAAC,kBAAA,gBAAAC,QAAA,oBACAN,EAAAd,aAAA,GAAA7B,GAAAC,KAAAE,SAAA0C,GAEAF,EAAAP,cACA,KAAAW,EAAAC,kBAAA,gBAAAC,QAAA,cAEAC,OAAAC,SAAAC,UAIA,SAAAL,EAAAD,EAAAO,GACAV,EAAAd,aAAA,OAGAa,GAGAY,OAAA,SAAAC,GACAzC,KAAAe,aAAA,IACA,IAAA2B,GAAA1C,KAAAqB,WAAA,gBAAAoB,EAAAA,EAAArB,EAAAN,oBACAsB,QAAAO,KAAAD,EAAA,WAIA,IAAAtB,GAAAlC,EAAAC,KAAAuB,WAEA,OAAAxB,KAEAD,OChEA,cACA,aACA,eAEA,SACAC,GAGA,YAEA,OAAAA;AHTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpBA,ADqBA;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClEA,ADmEA;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["define('NamespaceAuth',[\n\t\t'gdmap-core'\n\t],\n\tfunction(\n\t\tG\n\t)\n{\n\t'use strict';\n\n\t/**\n\t * @property {object} G.auth - Creates the auth namespace within the G namespace\n\t */\n\tG.auth = {};\n\n\t/**\n\t * @property {string} G.auth.version - Stores the version number of this module. Will be overridden during the build process\n\t */\n\tG.auth.version = '0.0.4-9';\n\n\treturn G;\n});\n","define('AuthUser',[\n\t\t'NamespaceAuth'\n\t],\n\tfunction(\n\t\tG\n\t)\n{\n\t'use strict';\n\t\n\tG.auth.AuthUser = G.core.Class.extend({\n\t\t_id: null,\n\t\t_displayName: null,\n\t\t_organisationName: null,\n\t\t_organisationCode: null,\n\t\t_json: null,\n\n\t\tinitialize: function(jsonObject)\n\t\t{\n\t\t\tthis._json = jsonObject;\n\t\t\tif(jsonObject !== null)\n\t\t\t{\n\t\t\t\tthis._id = jsonObject.id || null;\n\t\t\t\tthis._displayName = jsonObject.displayName || '';\n\t\t\t\tif(jsonObject.groups.length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis._organisationName = jsonObject.groups[0].name;\n\t\t\t\t\tthis._organisationCode = jsonObject.groups[0].value;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._organisationName = '';\n\t\t\t\t\tthis._organisationCode = '';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tObject.defineProperty(this, 'id', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn this._id;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(this, 'displayName', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn this._displayName;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(this, 'organisationName', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn this._organisationName;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(this, 'organisationCode', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn this._organisationCode;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(this, 'json', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn this._json;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n});\n","define('AuthManager',[\n\t\t'NamespaceAuth',\n\t\t'AuthUser'\n\t],\n\tfunction (G) {\n\t\t'use strict';\n\n\t\tG.auth.AuthManager = G.core.Class.extend({\n\t\t\tstatics: {\n\t\t\t\tDEFAULT_WHOAMI_SERVICE: 'https://services.geodan.nl/accounts/details',\n\t\t\t\tDEFAULT_LOGOUT_SERVICE: 'https://services.geodan.nl/cas/logout',\n\t\t\t\tDEFAULT_FORWARD_URL: 'http://www.geodan.nl'\n\t\t\t},\n\n\t\t\t_currentUser: null,\n\n\t\t\tinitialize: function (whoAmIServiceUrl, logoutServiceUrl, autoRefresh) {\n\t\t\t\tthis._currentUser = null;\n\t\t\t\tthis._whoAmIUrl = whoAmIServiceUrl ? whoAmIServiceUrl : ClassName.DEFAULT_WHOAMI_SERVICE;\n\t\t\t\tthis._logoutUrl = logoutServiceUrl ? logoutServiceUrl : ClassName.DEFAULT_LOGOUT_SERVICE;\n\t\t\t\tthis._autoRefresh = (autoRefresh === undefined || autoRefresh === null) ? true : autoRefresh; //Enable auto refresh automatically when not specified\n\n\t\t\t\tObject.defineProperty(this, 'currentUser', {\n\t\t\t\t\tget: function () {\n\t\t\t\t\t\treturn this._currentUser;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tidentifyUser: function (options) {\n\t\t\t\tthis._currentUser = null;\n\t\t\t\tvar requestManager = new G.core.RequestManager();\n\t\t\t\tvar request = requestManager.get(this._whoAmIUrl, options);\n\t\t\t\tvar self = this;\n\t\t\t\trequest.then(\n\t\t\t\t\tfunction (data, textStatus, jqXHR) {\n\t\t\t\t\t\tif (jqXHR.getResponseHeader('content-type').indexOf('application/json') !== -1) {\n\t\t\t\t\t\t\tself._currentUser = new G.auth.AuthUser(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (self._autoRefresh) {\n\t\t\t\t\t\t\tif (jqXHR.getResponseHeader('content-type').indexOf('text/html') !== -1) {\n\t\t\t\t\t\t\t\t//Request is redirected to login page. Refresh the window to let the client redirect to login page also.\n\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfunction (jqXHR, textStatus, errorThrown) {\n\t\t\t\t\t\tself._currentUser = null;\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\treturn request;\n\t\t\t},\n\n\t\t\tlogout: function (forwardUrl) {\n\t\t\t\tthis._currentUser = null;\n\t\t\t\tvar url = this._logoutUrl + '?forwardUrl=' + (forwardUrl ? forwardUrl : ClassName.DEFAULT_FORWARD_URL);\n\t\t\t\twindow.open(url, '_self');\n\t\t\t}\n\t\t});\n\n\t\tvar ClassName = G.auth.AuthManager;\n\n\t\treturn G;\n\t});\n","define('NamespaceAuth',[\n\t\t'gdmap-core'\n\t],\n\tfunction(\n\t\tG\n\t)\n{\n\t'use strict';\n\n\t/**\n\t * @property {object} G.auth - Creates the auth namespace within the G namespace\n\t */\n\tG.auth = {};\n\n\t/**\n\t * @property {string} G.auth.version - Stores the version number of this module. Will be overridden during the build process\n\t */\n\tG.auth.version = '0.0.4-9';\n\n\treturn G;\n});\ndefine('AuthUser',[\n\t\t'NamespaceAuth'\n\t],\n\tfunction(\n\t\tG\n\t)\n{\n\t'use strict';\n\t\n\tG.auth.AuthUser = G.core.Class.extend({\n\t\t_id: null,\n\t\t_displayName: null,\n\t\t_organisationName: null,\n\t\t_organisationCode: null,\n\t\t_json: null,\n\n\t\tinitialize: function(jsonObject)\n\t\t{\n\t\t\tthis._json = jsonObject;\n\t\t\tif(jsonObject !== null)\n\t\t\t{\n\t\t\t\tthis._id = jsonObject.id || null;\n\t\t\t\tthis._displayName = jsonObject.displayName || '';\n\t\t\t\tif(jsonObject.groups.length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis._organisationName = jsonObject.groups[0].name;\n\t\t\t\t\tthis._organisationCode = jsonObject.groups[0].value;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._organisationName = '';\n\t\t\t\t\tthis._organisationCode = '';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tObject.defineProperty(this, 'id', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn this._id;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(this, 'displayName', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn this._displayName;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(this, 'organisationName', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn this._organisationName;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(this, 'organisationCode', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn this._organisationCode;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(this, 'json', {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn this._json;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n});\ndefine('AuthManager',[\n\t\t'NamespaceAuth',\n\t\t'AuthUser'\n\t],\n\tfunction (G) {\n\t\t'use strict';\n\n\t\tG.auth.AuthManager = G.core.Class.extend({\n\t\t\tstatics: {\n\t\t\t\tDEFAULT_WHOAMI_SERVICE: 'https://services.geodan.nl/accounts/details',\n\t\t\t\tDEFAULT_LOGOUT_SERVICE: 'https://services.geodan.nl/cas/logout',\n\t\t\t\tDEFAULT_FORWARD_URL: 'http://www.geodan.nl'\n\t\t\t},\n\n\t\t\t_currentUser: null,\n\n\t\t\tinitialize: function (whoAmIServiceUrl, logoutServiceUrl, autoRefresh) {\n\t\t\t\tthis._currentUser = null;\n\t\t\t\tthis._whoAmIUrl = whoAmIServiceUrl ? whoAmIServiceUrl : ClassName.DEFAULT_WHOAMI_SERVICE;\n\t\t\t\tthis._logoutUrl = logoutServiceUrl ? logoutServiceUrl : ClassName.DEFAULT_LOGOUT_SERVICE;\n\t\t\t\tthis._autoRefresh = (autoRefresh === undefined || autoRefresh === null) ? true : autoRefresh; //Enable auto refresh automatically when not specified\n\n\t\t\t\tObject.defineProperty(this, 'currentUser', {\n\t\t\t\t\tget: function () {\n\t\t\t\t\t\treturn this._currentUser;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tidentifyUser: function (options) {\n\t\t\t\tthis._currentUser = null;\n\t\t\t\tvar requestManager = new G.core.RequestManager();\n\t\t\t\tvar request = requestManager.get(this._whoAmIUrl, options);\n\t\t\t\tvar self = this;\n\t\t\t\trequest.then(\n\t\t\t\t\tfunction (data, textStatus, jqXHR) {\n\t\t\t\t\t\tif (jqXHR.getResponseHeader('content-type').indexOf('application/json') !== -1) {\n\t\t\t\t\t\t\tself._currentUser = new G.auth.AuthUser(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (self._autoRefresh) {\n\t\t\t\t\t\t\tif (jqXHR.getResponseHeader('content-type').indexOf('text/html') !== -1) {\n\t\t\t\t\t\t\t\t//Request is redirected to login page. Refresh the window to let the client redirect to login page also.\n\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfunction (jqXHR, textStatus, errorThrown) {\n\t\t\t\t\t\tself._currentUser = null;\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\treturn request;\n\t\t\t},\n\n\t\t\tlogout: function (forwardUrl) {\n\t\t\t\tthis._currentUser = null;\n\t\t\t\tvar url = this._logoutUrl + '?forwardUrl=' + (forwardUrl ? forwardUrl : ClassName.DEFAULT_FORWARD_URL);\n\t\t\t\twindow.open(url, '_self');\n\t\t\t}\n\t\t});\n\n\t\tvar ClassName = G.auth.AuthManager;\n\n\t\treturn G;\n\t});\ndefine('gdmap-auth',[\n\t\t'gdmap-core',\n\t\t'AuthManager'\n\t],\n\tfunction(\n\t\tG\n\t)\n{\n\t'use strict';\n\t\n\treturn G;\n});\n\n//# sourceMappingURL=gdmap-auth.js.map"]}